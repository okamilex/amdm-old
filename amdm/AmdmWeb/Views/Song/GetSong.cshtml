@model AmdmWeb.Models.Song.SongPageModel

<nav class="breadcrumb">
    <a class="breadcrumb-item" href="@Url.Action("Index", "Home")">Main</a>
    /
    <a class="breadcrumb-item" href="@Url.Action("Performer", "Performer", new { performerId = Model.Song.PerformerId, s = Model.SortAndPageData.SongsSortingType, page = Model.BackPage})">@Model.PerfoemerName</a>
    /
    <span class="breadcrumb-item active">@Model.Song.Name</span>
</nav>
<script>
        $(document).ready(function () {
            $("#myBtn").click(function () {
                debugger;
                $("#myModal").modal();
                var ajaxURL = '@Url.Action("EditSong","Song")';
                var id = @Model.Song.Id;
                $.ajax({
                    type: "Get",
                    url: ajaxURL,
                    data: { songId: id},
                    dataType: 'html',
                    success: function (data) {
                        debugger;
                        $('#myModal').html(data);
                    },
                    replace: myModal

                });
            });
        });

</script>
<div>
    <h2>
        <a href="@Model.Song.SongPageLink">@Model.Song.Name <span class="badge">@Model.Song.Views</span></a>
        <a href="@Model.Song.VideoLink"><span class="glyphicon glyphicon-film" aria-hidden="true"></span></a>        
    </h2>
    <button type="button" class="btn btn-info btn-lg pull-right" id="myBtn">Edit</button><div id="myModal" class="modal fade" role="dialog"></div>
    
    <div class="container">
        <div class="row">
            @if (Model.Song.Number == 1)
            {
                using (Ajax.BeginForm("GetSong", new { performerId = Model.Song.PerformerId, s = Model.SortAndPageData.SongsSortingType, songNumber = Model.SortAndPageData.LasPageNumber }, new AjaxOptions { UpdateTargetId = "song", OnSuccess = "OnSuccess", HttpMethod = "Get" }))
                {
                    <input type="submit" class= "left carousel-control" value="<" />
                    
                }
            }
            else
            {
                using (Ajax.BeginForm("GetSong", new { performerId = Model.Song.PerformerId, s = Model.SortAndPageData.SongsSortingType, songNumber = Model.Song.Number - 1 }, new AjaxOptions { UpdateTargetId = "song", OnSuccess = "OnSuccess", HttpMethod = "Get" }))
                {
                    <input type="submit" class= "left carousel-control" value="<" />
                }
            }
            @if (Model.Song.Number == Model.SortAndPageData.LasPageNumber)
            {
                using (Ajax.BeginForm("GetSong", new { performerId = Model.Song.PerformerId, s = Model.SortAndPageData.SongsSortingType, songNumber = 1 }, new AjaxOptions { UpdateTargetId = "song", OnSuccess = "OnSuccess", HttpMethod = "Get" }))
                {
                    <input type="submit" class="right carousel-control" value=">" />
                }
            }
            else
            {
                using (Ajax.BeginForm("GetSong", new { performerId = Model.Song.PerformerId, s = Model.SortAndPageData.SongsSortingType, songNumber = Model.Song.Number + 1 }, new AjaxOptions { UpdateTargetId = "song", OnSuccess = "OnSuccess", HttpMethod = "Get" }))
                {
                    <input type="submit" class="right carousel-control" value=">" />
                }
            }
            
        </div>
    </div>    
</div>

<div id="carousel-example-generic" class="carousel slide col-lg-12">

    <div class="carousel-inner" role="listbox">
        <div class="item active">
            <table class="table table-striped">
                <tr>
                    <td class="col-md-6">
                        <pre>@Model.Song.Text</pre>
                    </td>
                    <td class="col-md-6">
                        <div class="container">
                            <div class="row">
                                @foreach (var chord in Model.Song.Chords)
                                {
                                    <div class="panel panel-info col-md-4">
                                        <div class="panel-heading">@chord.Name</div>
                                        <div class="panel-body">
                                            <img src=@chord.ImageLink />
                                        </div>
                                    </div>
                                }
                            </div>
                        </div>
                    </td>
                </tr>
            </table>
        </div>
    </div>

</div>

<script type="text/javascript">

        function OnSuccess(data) {
            history.replaceState(null, null, 'Song?performerId=' + @Model.Song.PerformerId + '&amp;s=' + '@Model.SortAndPageData.SongsSortingType' + '&amp;songNumber=' + @Model.Song.Number);            
        }


</script>
